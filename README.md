# Проект: Машинное обучение и разворачивание модели с использованием Docker

## 1. Создание датасета

1. Скачайте и установите архив nerus_lenta.conllu.gz и библиотеку nerus (инструкция в репозитории https://github.com/natasha/nerus)
2. Запустите скрипт **create_dataset.py**, который создаст train.csv и test.csv

## 2. Обучение модели

В скрипте **train.py** пропишите корректный путь к train.csv и к выходной директории, в которой будут храниться чекпоинты, и запустите его, предварительно установив необходимые библиотеки. Чекпоинт для итоговой модели лучше брать последний.

## 3. Развёртка docker-образа

В **Dockerfile** пропишите корректный путь к модели, и запустите скрипт **build.sh**, предварительно установив Docker Engine. Он создаст образ и запушит его в облако, выведя url, по которому будет храниться.

## 4. Имплементация

Docker-образ получится большой, 11Гб, поэтому встроить его классическим методом не получится. Зайдите в Caila и создайте сервер, предварительно создав сервис по инструкции. Настройка сервера:

1. в разделе Ресурс-группы создать группу с типом Docker
2. добавить в сервер, выбрать нужную конфигурацию. Ожидаемое время подключения сервера - 3-4 минуты.
3. далее в настройках сервиса указать:
- созданную ресурс группу
- лимиты ресурсов - максимально возможные.
- Pod start timeout - установить на 3600
4. на странице Хостинг нажми на плюсик
5. После развертки в testing можно отправить JSON, который будет содержать в себе ключ *texts*, по этому ключу должен храниться массив строк, которые мы хотим отправить модельке.
6. Посмотреть возвращенный JSON. Например, для JSON-файла:

{
    "texts": [
        "в семье Распутиных",
        "Жена президента США Дональда Трампа Мелания Трамп появилась на публике в среду, 12 декабря, с новым цветом волос, который рассмешил зрителей.",
        "Мужчина, расстрелявший людей во французском Страсбурге, мог быть членом террористической группировки «Исламское государство» (ИГ, запрещена в России).",
        "Исследователь в области кибербезопасности из Индии Сахад Нк (Sahad Nk) обнаружил уязвимости, которые позволяли злоумышленникам взломать любую учетную запись Microsoft."
    ]
}

вернуться должно 

{
    "enteties_list": [
        {
            "entities": []
        },
        {
            "entities": [
                {
                    "value": "Дональда",
                    "entity_type": "PERSON",
                    "span": {
                        "start_index": 20,
                        "end_index": 27
                    },
                    "entity": "Дональда",
                    "source_type": "SLOVNET"
                },
                {
                    "value": "Трампа",
                    "entity_type": "PERSON",
                    "span": {
                        "start_index": 29,
                        "end_index": 34
                    },
                    "entity": "Трампа",
                    "source_type": "SLOVNET"
                },
                {
                    "value": "Мелания",
                    "entity_type": "PERSON",
                    "span": {
                        "start_index": 36,
                        "end_index": 42
                    },
                    "entity": "Мелания",
                    "source_type": "SLOVNET"
                },
                {
                    "value": "Трамп",
                    "entity_type": "PERSON",
                    "span": {
                        "start_index": 29,
                        "end_index": 33
                    },
                    "entity": "Трамп",
                    "source_type": "SLOVNET"
                }
            ]
        },
        {
            "entities": []
        },
        {
            "entities": [
                {
                    "value": "Сахад",
                    "entity_type": "PERSON",
                    "span": {
                        "start_index": 51,
                        "end_index": 55
                    },
                    "entity": "Сахад",
                    "source_type": "SLOVNET"
                },
                {
                    "value": "Нк",
                    "entity_type": "PERSON",
                    "span": {
                        "start_index": 57,
                        "end_index": 58
                    },
                    "entity": "Нк",
                    "source_type": "SLOVNET"
                },
                {
                    "value": "(",
                    "entity_type": "PERSON",
                    "span": {
                        "start_index": 60,
                        "end_index": 60
                    },
                    "entity": "(",
                    "source_type": "SLOVNET"
                },
                {
                    "value": "Sahad",
                    "entity_type": "PERSON",
                    "span": {
                        "start_index": 61,
                        "end_index": 65
                    },
                    "entity": "Sahad",
                    "source_type": "SLOVNET"
                },
                {
                    "value": "Nk",
                    "entity_type": "PERSON",
                    "span": {
                        "start_index": 67,
                        "end_index": 68
                    },
                    "entity": "Nk",
                    "source_type": "SLOVNET"
                },
                {
                    "value": ")",
                    "entity_type": "PERSON",
                    "span": {
                        "start_index": 69,
                        "end_index": 69
                    },
                    "entity": ")",
                    "source_type": "SLOVNET"
                }
            ]
        }
    ]
}


## 5. Тестирование модели

Для тестирования модели предназначен класс **Tester**, который может вычислять метрики recall, precision и f1, а также вычислять скорость обработки символов в секунду.

## Ответы на вопросы:

1. Метрики precision, recall и f1 колеблются в райноне 90-94 процентов, в зависимости от выборки.
2. Виды ошибок модели

*Недостаток контекста*
Модель определяет имена скорее по контексту, чем по заранее существующим сформированным спискам имен. Поэтому, если в предложении контекст не позволит определить, что это имя, модель ошибётся

*Неоднозначность контекста*
В тексте могут встречаться слова, которые внешне похожи на имена, но ими не являются. Например, слово "Март" может быть как месяцем, так и именем. Контекст не всегда позволяет однозначно определить, о чём идет речь.

*Омонимия*
Некоторые имена совпадают с другими частями речи (например, существительными или глаголами). Например, имя "Мир" может быть воспринято как обычное существительное.

*Ошибки разметки данных*
При обучении модель могла столкнуться с некорректно размеченными данными. Например, имя могло быть пропущено или неправильно размечено, что привело к ошибкам в обучении.

*Разнообразие имен*
В текстах могут использоваться имена из разных культур и языков, включая транслитерации. Модель может не распознать такие имена или путать их с обычными словами.

*Ошибки в тексте*
Опечатки, неправильная пунктуация или использование неформального языка могут затруднять распознавание имён. Например, имя может быть написано с ошибкой, или же оно может быть частью сокращения.

*Многословные имена*
В некоторых культурах используются составные имена, которые состоят из нескольких слов. Модель может не распознать их как единое имя, особенно если составные части могут быть обычными словами.

3. Скорость выполнения - около 8000-8300 символов в секунду. Это зависит от того, на GPU или на CPU запускать, и от соответствующих аппаратных мощностей.

